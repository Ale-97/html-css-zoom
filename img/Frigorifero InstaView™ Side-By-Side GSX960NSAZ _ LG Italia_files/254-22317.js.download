try{if(!window.hasOwnProperty("flx1")){window.flx1={}}if(!window.flx1.hasOwnProperty("pixelQueue")){window.flx1.pixelQueue={queue:[],locked:false,uuidKnown:false,canPlace:function(){if(typeof navigator.onLine!=="undefined"&&navigator.onLine!==true){return false}return!this.locked},send:function(src,elementType,callback,preferSendBeacon){elementType=typeof elementType==="string"?elementType.toLowerCase():"script";if(preferSendBeacon){if(typeof navigator.sendBeacon!=="function"||typeof window["URL"]==="undefined"){this.send(src,elementType,callback,false);return}try{if(new URL(src).pathname!=="/ia"){this.send(src,elementType,callback,false);return}}catch(e){this.send(src,elementType,callback,false);return}navigator.sendBeacon(src,null)}else{var element=document.createElement(elementType);element.defer=true;element.async=true;element.src=src;document.getElementsByTagName("head")[0].appendChild(element)}if(typeof callback==="function"){callback()}},flush:function(){var next=this.queue.shift();while(next!=null){this.send(next.src,next.elementType,next.callback,true);next=this.queue.shift()}},place:function(src,elementType,callback){if(!this.canPlace()){this.queue.push({src:src,elementType:elementType,callback:callback});return}if(!this.uuidKnown){var element=document.createElement(elementType);element.defer=true;element.async=true;element.src=src;element.onload=function(){this.locked=false;this.uuidKnown=true;callback();this.flush()}.bind(this);document.getElementsByTagName("head")[0].appendChild(element)}else{this.locked=false;this.send(src,elementType,callback,true);this.flush()}}}}if(!window.flx1.hasOwnProperty("_instances")){window.flx1._instances={};if(typeof window.flx1["pxl"]==="function"){window.flx1._instances[window.flx1.cnf.id]=window.flx1}}if(typeof window["flx1_assign_22317"]!=="function"){window["flx1_assign_22317"]=function(){window.flx1._instances["22317"]=function(cnf){var dataQueue=[];var flushDataTimeout=null;function placePixel(src,elementType){if(typeof elementType=="undefined"){elementType="script"}window.flx1.pixelQueue.place(src,elementType,function(){if(typeof window.flx1_pixel_testing==="function"){window.flx1_pixel_testing({id:cnf.id,fn:"placePixel",args:arguments})}})}function pxl(e,elementType){var url=_getUrl(e);placePixel(url,elementType)}function _getUrl(e){try{var customData={};var pixelParams=getUrlParams(e);if(pixelParams.hasOwnProperty("data")){customData=JSON.parse(pixelParams.data)}customData.flx1_session_id=getSessionId();for(var i in pixelParams){if(!pixelParams.hasOwnProperty(i)){continue}}pixelParams.data=toJson(customData);var a=document.createElement("a");a.href=e;var pathname=a.pathname;var parsedParams=[];for(var key in pixelParams){if(!pixelParams.hasOwnProperty(key)){continue}parsedParams.push(key+"="+encodeURIComponent(pixelParams[key]))}if(parsedParams.length>0){e=pathname+"?"+parsedParams.join("&")}}catch(eSessionId){window.flx1._instances["22317"].log("session",eSessionId)}return"https://"+cnf.d+e+getAdditionalParams()+"&r="+encodeURIComponent(document.referrer)+"&eurl="+encodeURIComponent(document.location.href)+"&rndm="+Math.random()*1e16}function getSessionId(){try{var key="flx1_session_id_22317";var sessionId=getCookie(key,"");if(sessionId.length===0){sessionId=(Math.random()+(new Date).getTime()).toString(36)}var date=new Date;date.setMinutes(date.getMinutes()+parseInt("15",10));setCookie(key,sessionId,date.toUTCString());return sessionId}catch(eSessionId){window.flx1._instances["22317"].log("session",eSessionId)}return"0"}function sendData(k,v,customData,onFlush,dispatchEvent){if(typeof dispatchEvent==="undefined"){dispatchEvent=true}var obj={k:k,v:v,custom:typeof customData==="undefined"||customData===null?false:customData};if(document.dispatchEvent&&dispatchEvent){try{var ce;if(typeof CustomEvent==="function"){ce=new CustomEvent("sendData",{detail:obj})}else{ce=document.createEvent("CustomEvent");ce.initCustomEvent("sendData",false,false,obj)}document.dispatchEvent(ce)}catch(e){log(e)}}dataQueue.push(obj);if(flushDataTimeout!==null){clearTimeout(flushDataTimeout)}flushDataTimeout=setTimeout(function(){flushData();if(typeof onFlush==="function"){onFlush()}},100)}function flushData(){var url=flushDataUrl();if(url!==null){pxl(url)}}function flushDataUrl(){flushDataTimeout=null;if(dataQueue!==null&&dataQueue.length>0){var maxUrlLen=2048;var baseUrl="/px?id="+cnf.id+"&m="+cnf.m;var url=baseUrl;var customData={};var customDataStr="";for(var k in dataQueue){if(dataQueue.hasOwnProperty(k)){try{var elm=dataQueue[k];if(elm.custom===true){customData[elm.k]=elm.v;customDataStr="&data="+encodeURIComponent(toJson(customData))}else{url+="&"+elm.k+"="+encodeURIComponent(elm.v)}if(url.length+customDataStr.length>=maxUrlLen){pxl(url+customDataStr);url=baseUrl}}catch(e){log(e)}}}dataQueue=[];if(url!==baseUrl||customDataStr!==""){return url+customDataStr}}return null}function toJson(obj){var hasPrototypeToJsonFlag=window.Prototype&&Array.prototype.hasOwnProperty("toJSON");if(hasPrototypeToJsonFlag){var toJSON=Array.prototype.toJSON;delete Array.prototype.toJSON}var json;if(typeof JSON==="undefined"){json=minToJson(obj)}else{json=JSON.stringify(obj)}if(hasPrototypeToJsonFlag){Array.prototype.toJSON=toJSON}return json}function minToJson(obj){try{var arr=[];for(var k in obj){if(!obj.hasOwnProperty(k)){continue}var v=obj[k];var to=typeof v;if(to==="string"||to==="number"||to==="boolean"){var vStr=v+"";if(to==="string"){vStr='"'+vStr+'"'}arr.push('"'+k+'":'+vStr)}}return"{"+arr.join(",")+"}"}catch(e){return"{}"}}function log(e){try{window.console&&window.console.log&&window.console.log.apply(this,arguments)}catch(ec){window.console&&window.console.log&&window.console.log(e)}if(arguments.length>1&&typeof arguments[0]!=="object"){return}try{var errData={};if(typeof e!=="undefined"&&typeof e!==null){errData.err_msg=e.toString();if(typeof e["stack"]!=="undefined"&&e["stack"]!==null){errData.err_stack=e.stack.toString()}errData.err_pixel_id=cnf.id;errData.err_customer_id=cnf.m}placePixel("https://"+cnf.d+"/px?id=6864&m=11&data="+encodeURIComponent(toJson(errData)))}catch(forwardE){window.console&&window.console.log&&window.console.log(forwardE)}}function findCurrentScriptUrl(){var ret="";var scripts=document.getElementsByTagName("script");var searchString=cnf.m+"-"+cnf.id+".js";for(var i=0,j=scripts.length;i<j;i++){if(scripts[i].src&&scripts[i].src.indexOf(searchString)!==-1){return scripts[i].src}}return ret}function getUrlParams(url){var urlParams={};if(!url){url=findCurrentScriptUrl()}if(url&&url.indexOf("?")!==-1){var match,pl=new RegExp("[+]","g"),search=new RegExp("([^&=]+)=?([^&]*)","g"),decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=url.split("?")[1];while(match=search.exec(query)){urlParams[decode(match[1])]=decode(match[2].split("#")[0])}}return urlParams}function getAdditionalParams(){var additionalParams="";var urlParams=getUrlParams();var paramsToSkip={m:1,id:1,d:1};for(var p in urlParams){if(urlParams.hasOwnProperty(p)){if(!paramsToSkip[p]){additionalParams+="&"+p+"="+encodeURIComponent(urlParams[p])}}}try{var cookieUidVal=window.flx1._instances["22317"].getCookie("flx1uid","");if(cookieUidVal!==null&&cookieUidVal.length>0){additionalParams+="&uuid="+encodeURIComponent(cookieUidVal)}}catch(eCookie){window.flx1._instances["22317"].log(eCookie)}return additionalParams}function loadScript(a,b,defer){var c=document.createElement("script");if(typeof defer!=="undefined"&&defer===true){c.defer=true}c.async=true,c.readyState?c.onreadystatechange=function(){if(c.readyState==="loaded"||c.readyState==="complete")c.onreadystatechange=null,b&&b()}:c.onload=function(){b&&b()},c.src=a,document.getElementsByTagName("head")[0].appendChild(c)}function loadjQuery(callback){if(typeof window.flx1_jQuery==="undefined"){if(window.hasOwnProperty("flx1_jQuery_loading")&&window.flx1_jQuery_loading===true){var jQueryCheckInterval=setInterval(function(){if(typeof window.flx1_jQuery!=="undefined"){callback(window.flx1_jQuery);clearInterval(jQueryCheckInterval)}},200)}else{window.flx1_jQuery_loading=true;loadScript("https://"+cnf.d+"/flx1-jquery/1.11.2-20170607.min.js",function(){window.flx1_jQuery=window.flx1jQuery.noConflict(true);window.flx1_jQuery_loading=false;callback(window.flx1_jQuery)},true)}}else{callback(window.flx1_jQuery)}}if(typeof window.navigator.sendBeacon==="function"){var finalFlush=function(){try{var dataUrl=flushDataUrl();if(dataUrl!==null){var url=_getUrl(dataUrl);if(url!==null){navigator.sendBeacon(url)}}}catch(e){log(e)}};window.addEventListener("unload",finalFlush,false)}var registeredModules={};function registerModule(id,func){try{if(typeof registeredModules[id]!=="undefined"){log("Module "+id+" already registered, overwriting with new instance")}if(typeof func!=="function"){log("Not a function for "+id);return}registeredModules[id]=func}catch(e){log(e)}}function getModuleKeys(){return Object.keys(registeredModules)}function loadModule(id){try{if(typeof registeredModules[id]!=="function"){log("No function registered for "+id);return}registeredModules[id]()}catch(e){log(e)}}function registerProperty(name,value,registerGlobal){if(typeof registerGlobal!=="undefined"&&registerGlobal===true){window.flx1[name]=value}window.flx1._instances["22317"][name]=value}var _mutationObserverInstance=null;var _mutationObserverCallbacks={};function getMutationObserver(key,callback){if(_mutationObserverCallbacks.hasOwnProperty(key)===false){_mutationObserverCallbacks[key]=callback}if(_mutationObserverInstance===null){try{var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;_mutationObserverInstance=new MutationObserver(function(){for(var i in _mutationObserverCallbacks){if(!_mutationObserverCallbacks.hasOwnProperty(i)){continue}_mutationObserverCallbacks[i]()}}).observe(document,{subtree:true,attributes:true,childList:true})}catch(e){log(e)}}return _mutationObserverInstance}function isDebug(){return window.location.hash.indexOf("flx1log")!==-1}function setCookie(key,value,expires){var cookie=key+"="+value+";path=/;";if(window.location.protocol==="https:"){cookie+=" Secure;"}if(expires!==undefined){cookie+=";expires="+expires}document.cookie=cookie}function getCookie(key,def){var name=key+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1)}if(c.indexOf(name)===0){return c.substring(name.length,c.length)}}return def}return{pxl:pxl,_pxl:placePixel,cnf:cnf,log:log,data:sendData,getUrlParams:getUrlParams,jQuery:loadjQuery,loadScript:loadScript,registerModule:registerModule,registerProperty:registerProperty,loadModule:loadModule,getModuleKeys:getModuleKeys,toJson:toJson,getMutationObserver:getMutationObserver,debug:isDebug,getCookie:getCookie,setCookie:setCookie}}({id:"22317",m:"254",d:"go.flx1.com"});(function(){try{var run=function(){var self=window.flx1._instances["22317"];var params=self.getUrlParams(document.URL);if(params.hasOwnProperty("dmc_uid")===false){if(!params.hasOwnProperty("uid")||!params.hasOwnProperty("mid")){return}if(!((params.uid+"").match(/^[0-9]+$/)&&(params.mid+"").match(/^[0-9]+$/)&&(params.uid+"").length>=5)){return}params.dmc_uid=params.uid}var platformId=113;self.data("pl",platformId);self.data("euid",params.dmc_uid);self.data("dmc_uid",params.dmc_uid,true);self.pxl("/uid?m="+self.cnf.m+"&pl="+platformId+"&userid="+params.dmc_uid);if(params.hasOwnProperty("dmc_cid")){self.data("dmc_cid",params.dmc_cid,true)}if(params.hasOwnProperty("dmc_gid")){self.data("dmc_gid",params.dmc_gid,true);self.data("epx",params.dmc_gid)}if(params.hasOwnProperty("dmc_ch")){self.data("dmc_ch",params.dmc_ch,true)}if(params.hasOwnProperty("dmc_mid")){self.data("dmc_mid",params.dmc_mid,true)}};var moduleName="teradata_dmc";window.flx1._instances["22317"].registerModule(moduleName,run);window.flx1._instances["22317"].loadModule(moduleName)}catch(e){window.flx1._instances["22317"].log(e)}})();(function(){try{var run=function(){var inFocusSeconds=0;setInterval(function(){if(typeof document.hasFocus!=="function"||document.hasFocus()===true){inFocusSeconds++;switch(inFocusSeconds){case 5:case 10:case 20:case 30:case 60:case 90:case 120:case 180:case 240:case 300:window.flx1._instances["22317"].pxl("/ia?id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m+"&it=4&iv="+inFocusSeconds);break}}},1e3)};var moduleName="timeonsite";window.flx1._instances["22317"].registerModule(moduleName,run);window.flx1._instances["22317"].loadModule(moduleName)}catch(e){window.flx1._instances["22317"].log(e)}})();(function(){try{var run=function(){if(window!==window.top){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("iframe found")}return}window.flx1._instances["22317"].jQuery(function(jq){var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName("body")[0],screenHeight=w.innerHeight||e.clientHeight||g.clientHeight;var body=d.body,html=d.documentElement;var height=Math.max(jq("body").height(),jq("html").height());function getScrollTop(){if(typeof pageYOffset!=="undefined"){return pageYOffset}else{var B=d.body;var D=d.documentElement;D=D.clientHeight?D:B;return D.scrollTop}}var max=0;var ofs=[1,.75,.5,.25,.1];setInterval(function(){if(height>=screenHeight&&getScrollTop()>=0){var x=getScrollTop()/(height-screenHeight);if(x>max){for(var k in ofs){if(ofs.hasOwnProperty(k)&&x>=ofs[k]&&ofs[k]>=max){var val=ofs[k];max=x;window.flx1._instances["22317"].pxl("/ia?id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m+"&it=8&iv="+val*100);break}}}}else{if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("height: "+height,"screenHeight: "+screenHeight,"getScrollTop: "+getScrollTop())}}},500)})};var moduleName="scrolldepth";window.flx1._instances["22317"].registerModule(moduleName,run);window.flx1._instances["22317"].loadModule(moduleName)}catch(e){window.flx1._instances["22317"].log(e)}})();(function(){var run=function(){try{function addListeners(elms){for(var k in elms){if(!elms.hasOwnProperty(k)){continue}var elm=elms[k];if(typeof elm.type==="undefined"||elm.type===null||elm.type==="hidden"||elm.type==="submit"||elm.type==="button"){continue}elm.addEventListener("focus",function(){formpx(this,12,1)});elm.addEventListener("click",function(){formpx(this,13,1)});elm.addEventListener("keyup",function(){formpx(this,14,1)})}}function formpx(elm,t,v){try{var k="_flx1_"+t+"_"+v;if(elm.hasAttribute(k)){return}elm.setAttribute(k,"1");window.flx1._instances["22317"].pxl("/ia?id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m+"&it="+t+"&iv="+v)}catch(e){window.flx1._instances["22317"].log(e)}}addListeners(document.getElementsByTagName("input"));addListeners(document.getElementsByTagName("select"))}catch(e){window.flx1._instances["22317"].log(e)}};var moduleName="form_interact";window.flx1._instances["22317"].registerModule(moduleName,run);window.flx1._instances["22317"].loadModule(moduleName)})();(function(){try{var run=function(){if(window.hasOwnProperty("flx1")===false){console.log("No DMP Pixel found.");return}if(hasDebugFlag()===false){return}var endpoint=getDebugEndpoint();var link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.href=endpoint+"css/pixel-debug.css";var script=document.createElement("script");script.type="text/javascript";script.src=endpoint+"js/pixel-debug.js";var csspath=document.createElement("script");csspath.type="text/javascript";csspath.src=endpoint+"js/css-path.js";document.head.appendChild(link);document.head.appendChild(csspath);document.head.appendChild(script);draw(0)};var draw=function(retryCount){if(retryCount===6){return}if(typeof debugDrawer==="function"){debugDrawer()}else{setTimeout(draw,500,retryCount+1)}};var hasDebugFlag=function(){var debugEnabled=false;var debugParam=window.flx1._instances["22317"].getCookie("flx1debug",window.flx1._instances["22317"].getUrlParams(document.URL)["flx1debug"]);if(typeof debugParam!=="undefined"&&(debugParam==="1"||debugParam==="22317")){debugEnabled=true}return debugEnabled};var getDebugEndpoint=function(){var endpoint="https://platform.flxone.com/";var endpointParam=window.flx1._instances["22317"].getUrlParams(document.URL)["debugEndpoint"];if(typeof endpointParam!=="undefined"){endpoint=endpointParam}return endpoint};var moduleName="debug";window.flx1._instances["22317"].registerModule(moduleName,run);window.flx1._instances["22317"].loadModule(moduleName)}catch(e){window.flx1._instances["22317"].log(e)}})();(function(){try{var init=function(){window.flx1._instances["22317"].jQuery(function($){var eurl=window.location.href.split("#")[0];window.flx1._instances["22317"]._pxl("https://"+window.flx1._instances["22317"].cnf.d+"/context?_check=1&callback=1&id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m+"&eurl="+encodeURIComponent(eurl));window.flxoneContextualDataCallback=function(callbackId,response){if(response&&response.hasOwnProperty("labels")&&response.labels.length>0){window.flx1._instances["22317"].data("contextual_data",{labels:response.labels},true)}}})};var moduleName="contextual_data";window.flx1._instances["22317"].registerModule(moduleName,init);window.flx1._instances["22317"].loadModule(moduleName)}catch(e){window.flx1._instances["22317"].log(e)}})();(function(){function getTextContentExceptScript(element){var text=[];var self=arguments.callee;var els=element.childNodes;var nodeType={element:1,text:3};var elsLength=els.length;for(var i=0;i<elsLength;i++){var el=els[i];if(el.nodeType===nodeType.element&&el.tagName&&el.tagName.toLowerCase()!=="script"&&el.tagName.toLowerCase()!=="noscript"&&el.tagName.toLowerCase()!=="style"){text.push(self(el))}else if(el.nodeType===nodeType.text){text.push(el.data)}}return text.join(" ").replace(/\s{2,}/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function loadScript(a,b){return window.flx1._instances["22317"].loadScript(a,b)}function loadImage(source){!function(n){n.onload=function(){},n.src=source}(new Image)}function loadIframe(source){var iframe=document.createElement("iframe");iframe.src=source;iframe.width=1;iframe.height=1;iframe.frameBorder=0;iframe.style.display="none";document.getElementsByTagName("body")[0].appendChild(iframe)}function loadjQuery(callback){return window.flx1._instances["22317"].jQuery(callback)}function executeAfter(times,callback){return{seen:{},next:function(id,isTrigger){if(id===undefined){id=0}if(this.seen[id]===undefined){this.seen[id]=1}else{this.seen[id]++}if(this.seen[id]===times||isTrigger!=="undefined"&&isTrigger){callback()}}}}function executeAfterAll(expectedTotalEventSize,callback){return{seen:[],next:function(id){if(id===undefined){id=0}if(this.seen.indexOf(id)!==-1){return}this.seen.push(id);var seenCount=this.seen.length;if(seenCount===expectedTotalEventSize){callback()}}}}function getInteractionValue(options){var interactionValue="0";if(options.hasOwnProperty("assign_value")){interactionValue=options.assign_value;if(typeof interactionValue==="string"){interactionValue=interactionValue.replace(/,/g,".")}}return interactionValue}function getExpirationValue(options){var expiration=false;if(options.hasOwnProperty("expiration")){expiration=options.expiration}var expirationValue=0;if(expiration){if(options.hasOwnProperty("expiration_value")&&options.hasOwnProperty("expiration_unit")){expirationValue=parseInt(options.expiration_value,10);var expirationUnit=options.expiration_unit;switch(expirationUnit){case"minutes":expirationValue=expirationValue*60;break;case"hours":expirationValue=expirationValue*60*60;break;case"days":default:expirationValue=expirationValue*60*60*24;break}}}return expirationValue}function getNumericFromText(value){if(value==null||typeof value!=="string"){return value}var match=value.match(/-?\d+(?:[.,]\d+)*/);if(match!==null){value=match[0];var lastCommaIndex=value.lastIndexOf(",");var lastDotIndex=value.lastIndexOf(".");if(lastCommaIndex>lastDotIndex){value=value.replace(".","").replace(",",".")}else{value=value.replace(",","")}}return value}function getCurrentTime(){function pad(n){return Number(n)<10?"0"+n:String(n)}var dateNow=new Date;var offset=dateNow.getTimezoneOffset();return dateNow.getFullYear()+"-"+pad(dateNow.getMonth()+1)+"-"+pad(dateNow.getDate())+"T"+pad(dateNow.getHours())+":"+pad(dateNow.getMinutes())+":"+pad(dateNow.getSeconds())+"."+String((dateNow.getMilliseconds()/1e3).toFixed(3)).slice(2,5)+(offset<0?"+":"-")+pad(Math.abs(offset/60))+":"+pad(Math.abs(offset%60))}function hook(ownerTypeName,ownerMethodName,overrideBefore){var main=window;if(main==null){window.flx1._instances["22317"].log("Hook failed because main/window object on page is null");return}if(overrideBefore!==undefined&&typeof overrideBefore!=="function"){window.flx1._instances["22317"].log("Argument 'overrideBefore' is not a function.");return}var owner=main[ownerTypeName];if(owner==null){window.flx1._instances["22317"].log("Cannot override null type: "+ownerTypeName);return}var prototype;var originalMethod;switch(ownerMethodName){case"constructor":originalMethod=main[ownerTypeName];main[ownerTypeName]=function(){try{overrideBefore.apply(this,arguments)}catch(e){}return originalMethod.apply(this,arguments)};break;default:prototype=owner["prototype"];if(prototype==null){prototype=owner}originalMethod=prototype[ownerMethodName];if(originalMethod==null){window.flx1._instances["22317"].log("Cannot override type '"+ownerTypeName+"' on method '"+ownerMethodName+"' because it does not exist.");return}if(typeof originalMethod!=="function"){window.flx1._instances["22317"].log("Cannot override type '"+ownerTypeName+"' on a method with the name '"+ownerMethodName+"' because this member isn't a method.");return}prototype[ownerMethodName]=function(){try{overrideBefore.apply(this,arguments)}catch(e){}return originalMethod.apply(this,arguments)}}}function tryCast(type,value){switch(type){case"int":case"integer":var num=parseInt(getNumericFromText(value),10);return num!==num?null:num;case"number":case"float":var float=parseFloat(getNumericFromText(value));return float!==float?null:float;case"id":if(typeof value!=="string"){value=tryCast(undefined,value)}if(value==null){return value}var matches=value.match(/^([^:]+):\s+([^\s\r\n]+)\s*$/i);if(matches!=null&&typeof matches[2]==="string"){return matches[2]}return value;case"string":if(value==null){return null}if(typeof value==="string"){return value}if(value.hasOwnProperty("toString")){return value.toString()}return null;default:if(value!=null&&typeof value!=="string"){if(value.hasOwnProperty("toString")){value=value.toString()}else{try{value=JSON.stringify(value)}catch(e){value=null}}}return value===undefined?null:value}}function tryCastOrDefault(type,value,defaultValue){if(type==null){throw new Error("Argument 'type' should not be null.")}if(type!==typeof value){value=tryCast(type,value)}if(value==null){return tryCast(type,defaultValue)}return value}function getExternalData(externalData){try{if(externalData.hasOwnProperty("name")===false||externalData.hasOwnProperty("css_path")===false){return null}var cssPath=externalData.css_path;if(typeof cssPath!=="string"||cssPath.length===0){return null}var name=externalData.name;if(typeof name!=="string"||name.length===0){return null}var defaultValue="";if(externalData.hasOwnProperty("default_value")){defaultValue=externalData.default_value}var element=window.flx1_jQuery(cssPath);if(element.length===0&&defaultValue.length===0){return null}var value;if(element.is("img")){value=element.attr("src")}else if(element.is("meta")){value=element.attr("content")}else if(element.is("a")){value=element.attr("href")}else{value=element.val()||element.text()}if(typeof value==="undefined"||value.length===0){value=defaultValue}if(typeof value==="string"&&value.length===0){return null}if(externalData.type){value=tryCastOrDefault(externalData.type,value,defaultValue)}var object={};object[name]=typeof externalData.postProcess==="function"?externalData.postProcess(value):value;return object}catch(e){window.flx1._instances["22317"].log(e)}return null}function populateExternalPixels(options,type){window.flx1_jQuery(function(){if(options.populate_external_pixels){document.write=document.writeln=function(html){var hiddenElement=window.flx1_jQuery("body").find("#flx1");if(hiddenElement.length===0){hiddenElement=window.flx1_jQuery('<div id="flx1" style="display: none;"></div>');window.flx1_jQuery("body").append(hiddenElement)}hiddenElement.append(html)};try{if(options.hasOwnProperty("external_pixel_url")){var externalPixelUrl=options.external_pixel_url;if(externalPixelUrl.length>0){var externalPixelUrlType=options.external_pixel_url_type;if(externalPixelUrlType==="script"){loadScript(externalPixelUrl)}else if(externalPixelUrlType==="image"){loadImage(externalPixelUrl)}else if(externalPixelUrlType==="iframe"){loadIframe(externalPixelUrl)}}}if(options.hasOwnProperty("external_pixel_script")){var externalPixelScript=options.external_pixel_script;if(externalPixelScript.length>0){try{if(externalPixelScript.trim().indexOf("<script")===-1){externalPixelScript="<script>"+externalPixelScript+"<\/script>"}window.flx1_jQuery("head").append(externalPixelScript)}catch(e){window.flx1._instances["22317"].log(e)}}}}catch(e){window.flx1._instances["22317"].log(e)}if(options.hasOwnProperty("externalPixels")){var pixels=options.externalPixels;for(var i in pixels){if(!pixels.hasOwnProperty(i)){continue}var pixel=pixels[i];if(!options.hasOwnProperty("platform")){continue}var platform=options.platform;switch(platform){case"appnexus":if(type==="segment"){loadScript("https://secure.adnxs.com/seg?add="+pixel+"&t=1")}else if(type==="conversion"){loadScript("https://secure.adnxs.com/px?id="+pixel+"&t=1")}break;case"google":case"google_dbm":var axel=Math.random()+"";var a=axel*1e13;var source="https://"+pixel+".fls.doubleclick.net/activityi;src="+pixel+";type=invmedia;cat=wnvjf0w9;ord="+a+"?";loadIframe(source);break;default:window.flx1._instances["22317"].log("Unsupported platform: "+platform);break}}}}})}function checkAndDropConversionCountCookie(conversionCountKey,options){var firePixel=true;var conversionCountExpiresKey=conversionCountKey+"_expires";var conversionCount=parseInt(window.flx1._instances["22317"].getCookie(conversionCountKey,0),10);var conversionCountType=options.conversion_count_type;switch(conversionCountType){case"one_per_user":if(conversionCount>0){firePixel=false}else if(conversionCount===0){var date=new Date;date.setFullYear(date.getFullYear()+1);window.flx1._instances["22317"].setCookie(conversionCountKey,1,date.toUTCString())}break;case"all_per_user":break;case"custom_per_user":if(options.hasOwnProperty("custom_conversion_count_per")&&options.hasOwnProperty("custom_conversion_count_number")&&options.hasOwnProperty("custom_conversion_count_unit")){var conversionCountPer=parseInt(options.custom_conversion_count_per,10);var conversionCountNumber=parseInt(options.custom_conversion_count_number,10);var conversionCountUnit=options.custom_conversion_count_unit;var conversionCountExpires;switch(conversionCountUnit){case"minutes":conversionCountExpires=conversionCountPer*60;break;case"hours":conversionCountExpires=conversionCountPer*60*60;break;case"days":default:conversionCountExpires=conversionCountPer*60*60*24;break}if(conversionCount>=conversionCountNumber){firePixel=false}else{var date=new Date;date.setTime(date.getTime()+conversionCountExpires*1e3);if(conversionCount===0){window.flx1._instances["22317"].setCookie(conversionCountExpiresKey,date.getTime(),date.toUTCString())}else{date.setTime(window.flx1._instances["22317"].getCookie(conversionCountExpiresKey,date.getTime()))}window.flx1._instances["22317"].setCookie(conversionCountKey,conversionCount+1,date.toUTCString())}}break}return firePixel}function doCheck(checks){try{for(var x in checks){if(!checks.hasOwnProperty(x)){continue}var check=checks[x];if(!check.hasOwnProperty("options")){continue}var options=check.options;for(var y in options){if(!options.hasOwnProperty(y)){continue}try{options[y].check()}catch(e){window.flx1._instances["22317"].log(e)}}}}catch(e){window.flx1._instances["22317"].log(e)}}loadjQuery(function($){try{var name="rule_type_handler_default";window.flx1._instances["22317"].registerProperty(name,{mustHaveData:false,getPath:function(id,interactionType,options){return"/ia?id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m+"&itst="+id+"&it="+interactionType},getData:function(options){if(options.hasOwnProperty("populate_external_data")&&options.populate_external_data===true&&options.hasOwnProperty("external_data")){var size=options.external_data.length;if(size>0){var data={};$.each(options.external_data,function(i,externalData){var entry=getExternalData(externalData);if(entry!==null){$.extend(data,entry)}});return data}}return null},firePixels:function(path,data,options){if(data!==null){path+="&data="+encodeURIComponent(window.flx1._instances["22317"].toJson(data))}window.flx1._instances["22317"].pxl(path)}})}catch(e){window.flx1._instances["22317"].log(e)}try{window.flx1._instances["22317"].registerProperty("rule_type_handler_conversion",{mustHaveData:false,getPath:function(id,interactionType,options){var interactionValue=getInteractionValue(options);var expirationValue=getExpirationValue(options);var firePixel=true;if(options.hasOwnProperty("conversion_count_type")){var conversionCountKey="flx1_conversion_count_"+id;firePixel=checkAndDropConversionCountCookie(conversionCountKey,options)}if(firePixel){var path=window.flx1._instances["22317"]["rule_type_handler_default"].getPath(id,interactionType,options);path+="&iv="+interactionValue;if(expirationValue>0){path+="&exp="+expirationValue}return path}return null},getData:function(options){return window.flx1._instances["22317"]["rule_type_handler_default"].getData(options)},firePixels:function(path,data,options){window.flx1._instances["22317"]["rule_type_handler_default"].firePixels(path,data,options)}})}catch(e){window.flx1._instances["22317"].log(e)}(function(){try{var flxUtils=new function(){this.getType=function(obj){return Object.prototype.toString.call(obj).match(/([a-zA-Z]+)\]$/)[1].toLowerCase()};this.Object={toArray:function(obj){if(typeof obj!=="object"){return[]}return[].slice.call(obj)}};this.Array={iterateDelayed:function(arr,assert,callback,wait,retries,i){if(arr==null){callback(undefined);return}var self=this;i=i==null?0:i;wait=wait==null?100:wait;retries=retries==null?0:retries;if(i>=arr.length){if(retries){setTimeout(function(){self.iterateDelayed(arr,assert,callback,wait,--retries,0)},wait)}else{callback(undefined)}return}for(;i<arr.length;i++){if(assert(arr[i])){callback(arr[i]);return}}setTimeout(function(){self.iterateDelayed(arr,assert,callback,wait,retries,0)},wait)}}};var FlxTransaction=function(){if(FlxTransaction.instance==null){FlxTransaction.instance=this}else{return FlxTransaction.instance}this.promise={_promise:null,reset:function(){this._promise=$.Deferred();this._promise.always(this.reset)},notify:function(eventData){this._promise.resolve(eventData)}};this.uuidv4=function(){var d=(new Date).getTime();var d2=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16;if(d>0){r=(d+r)%16|0;d=Math.floor(d/16)}else{r=(d2+r)%16|0;d2=Math.floor(d2/16)}return(c==="x"?r:r&3|8).toString(16)})};this.callbacks={handlers:{},queue:[],add:function(event,id,callback){this.handlers[event]=this.handlers[event]||{};this.handlers[event][id]=this.handlers[event][id]||{};this.handlers[event][id].callback=callback;for(var prop in this.queue){if(!this.queue.hasOwnProperty(prop)){continue}callback(this.queue[prop])}},call:function(data){this.queue.push(data);for(var eventName in this.handlers){if(!this.handlers.hasOwnProperty(eventName)){continue}var event=this.handlers[eventName];for(var instanceId in event){if(!event.hasOwnProperty(instanceId)){continue}var eventInstance=event[instanceId];eventInstance.callback(data)}}}};this.matchEvent=function(args,constructor){var context={fields:[],path:function(jsonpath){return window.flx1.jsonpath.path({path:jsonpath,json:args})},pushField:function(name,value,castType,defaultValue,share){if(typeof name!=="string"){console.error("Field name is not a string:"+name);return}if(castType==null){FlxTransaction.instance.logDebug('Using default type "string" for field:',"'"+name+"'");castType="string"}var actualFieldType=share==null&&flxUtils.getType(value)||flxUtils.getType(value[0]);share=share||(castType!=="array"&&actualFieldType==="array"?"multiple":undefined);if(share==="single"&&value!=null&&value.length===1&&flxUtils.getType(value)==="array"){value=value[0]}this.fields.push({name:name,values:value,castType:castType,realType:actualFieldType,share:share,defaultValue:defaultValue})},construct:function(){if(this.fields.length<1){return[]}var result=[];var maxValues=0;for(var i=0;i<this.fields.length;i++){var field=this.fields[i];if(!field.share){continue}if(Object.prototype.toString.call(field.values)==="[object String]"){continue}maxValues=maxValues<field.values.length?field.values.length:maxValues}for(var i=0;i<maxValues;i++){var item={};for(var j=0;j<this.fields.length;j++){var field=this.fields[j];var fieldVal=null;if(field.share){if(field.share==="single"){fieldVal=field.values}else{fieldVal=field.values[i]}}else{if(field.realType==="array"&&field.values.length===1){fieldVal=field.values[0]}else{fieldVal=field.values}}fieldVal=tryCastOrDefault(field.castType,fieldVal,field.defaultValue);if(fieldVal!==null){item[field.name]=fieldVal}}result[i]=item}return result}};constructor.bind(context)();return context.construct()}.bind(this);this.getPromise=function(){return this.promise._promise}.bind(this);this.logDebug=function(){if(window.flx1._instances["22317"].debug()){var logArgs=["[flx_transaction]"].concat(flxUtils.Object.toArray(arguments));window.flx1._instances["22317"].log.apply(this,logArgs)}}.bind(this);this.createHook=function(sourceFunc,customFunc){if(typeof customFunc!=="function"){this.logDebug("Hook is not a function");return sourceFunc}if(typeof sourceFunc!=="function"){this.logDebug("Hook target is not a function");return null}this.logDebug("Hook target",sourceFunc.name);this.logDebug("Hook trampoline",customFunc.name||"anonymous function");var prev=sourceFunc;var self=this;sourceFunc=function(){try{var args=flxUtils.Object.toArray(arguments);if(args!=null){var indexer=0;while(args[indexer]!=null){if(flxUtils.getType(args[indexer])==="arguments"){args[indexer]=flxUtils.Object.toArray(args[indexer])}indexer++}}customFunc.apply(self,args)}finally{prev.apply(this,arguments)}};return sourceFunc}.bind(this);this.hookGA=function(){window.ga=this.createHook(window.ga,function(args){this.callbacks.call(args)}.bind(this))}.bind(this);this.hookDataLayer=function(){if(typeof window.dataLayer.push!=="function"){this.logDebug("dataLayer does not have push method to override.");return false}window.dataLayer.push=this.createHook(window.dataLayer.push,function(args){this.callbacks.call(args)}.bind(this));var dl=window.dataLayer;for(var prop in dl){if(!dl.hasOwnProperty(prop)||typeof dl[prop]!=="object"){continue}this.callbacks.call(dl[prop])}}.bind(this);this.supportedEcommerceApis=[{name:"Data Layer",assert:function(){return window.dataLayer!=null},hook:this.hookDataLayer},{name:"Google Analytics",assert:function(){return window.ga&&window.ga.loaded},hook:this.hookGA}];this.promise.reset();flxUtils.Array.iterateDelayed(this.supportedEcommerceApis,function(api){return api.assert()},function(api){if(api==null||api.hook()===false){this.logDebug("Failed to initializes flx");return}this.logDebug("Initialized on "+api.name)}.bind(this),10,50);return this};window.flx1._instances["22317"].registerProperty("google_merchant",FlxTransaction)}catch(e){window.flx1._instances["22317"].log(e)}})();"use strict";function _createForOfIteratorHelper(a,b){var c;if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=a[Symbol.iterator]()},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c.return||c.return()}finally{if(h)throw f}}}}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(){var a=function(){function a(){_classCallCheck(this,a),this.patterns={root:{prefixes:[null],pattern:/^\$/},child:{prefixes:["root","property","descendantValues","type","filter","childValues"],pattern:/^\./,subsetOf:{descendant:{prefixes:["root","property","type"],pattern:/^\./,subsetOf:{descendantValues:{prefixes:["root","property","type"],pattern:/^\*/}}},childValues:{prefixes:["root","property","type","childValues"],pattern:/^\*/}}},property:{prefixes:["child","descendant","filter"],pattern:/^[^.@\[\]]+/},type:{prefixes:["childValues","property","descendant","descendantValues","filter"],pattern:/^@(object|array|string|number|boolean)\(\)/},filter:{prefixes:["property","type","descendant","descendantValues","childValues","filter"],pattern:/^\[\?\(([^)]+)\)\]/}}}return _createClass(a,[{key:"recursiveSearch",value:function recursiveSearch(a,b){if(null==a)return[];for(var c=[],d=0,e=Object.entries(a);d<e.length;d++){var f=_slicedToArray(e[d],2),g=f[0],h=f[1],i=b(g,h);if((!0===i||!0===i.match)&&c.push(!0===i?h:i.value),"string"!=typeof h&&("object"===_typeof(h)||Array.isArray(a))){var j,k=this.recursiveSearch(h,b),l=_createForOfIteratorHelper(k);try{for(l.s();!(j=l.n()).done;){var m=j.value;c.push(m)}}catch(a){l.e(a)}finally{l.f()}}}return c}},{key:"isType",value:function isType(a,b){return"array"===b?Array.isArray(a):"object"===b?"object"===_typeof(a)&&!Array.isArray(a):_typeof(a)===b}},{key:"tokenize",value:function tokenize(a){for(var b=null,c=a,d=[],e=0;e<a.length;e++){for(var f=e,g=null,h=0,j=0,k=Object.entries(this.patterns);j<k.length;j++){var l=_slicedToArray(k[j],2),m=l[0],n=l[1];if(n.prefixes.includes(b)&&(g=c.match(n.pattern),!!g)&&(h=g[0].length,!(1>h))){if(n.subsetOf){var o=n,p=c.substr(g[0].length);if(p.length){for(var q=null,r=null,s=null;null!=o&&null!=o.subsetOf&&0<p.length;){for(var t=!1,u=0,v=Object.entries(o.subsetOf);u<v.length;u++){var w=_slicedToArray(v[u],2),x=w[0],y=w[1];if(y.prefixes.includes(b)){var z=p.match(y.pattern);if(z&&!(1>z[0].length)){t=!0,r=z,s=x,q=y,o=y;break}}}if(!t)break;else p=p.substr(r[0].length),h+=r[0].length}null!==q&&(g=r,n=q,m=s)}}f=-1,c=c.substr(h),b=m;break}}if(-1<f)throw new Error("Invalid syntax at position "+e+": '"+a.substr(f)+"'");var A=g[1]||a.substr(e,h),B=parseFloat(A);(B||0===B)&&(A=B),d.push({name:b,value:A}),e+=h-1}return d}},{key:"path",value:function(a){var b=this;if(null==a)throw new Error('Missing required "json" and "path" options.');var c=a.json;if(null==c)throw new Error('Missing required "json" option');if(null==a.path)throw new Error('Missing required "path" option');var d=a.path;if("string"!=typeof d)throw new Error('Option "path" must be a string.');if("object"!==_typeof(c)||Array.isArray(c)&&1>c.length)return[];if(1>d.length)return[];for(var e=this.tokenize(d),f=[],g=function(a){var d=e[a],g=e[a+1]||{name:null,value:null};switch(d.name){case"root":f=[c];break;case"child":if("property"===g.name){var h,i=[],j=_createForOfIteratorHelper(f);try{for(j.s();!(h=j.n()).done;){var A=h.value;A&&A.hasOwnProperty&&A.hasOwnProperty(g.value)&&i.push(A[g.value])}}catch(a){j.e(a)}finally{j.f()}f=i}break;case"childValues":var k,l=[],m=_createForOfIteratorHelper(f);try{for(m.s();!(k=m.n()).done;)for(var n,o=k.value,p=0,q=Object.values(o);p<q.length;p++)n=q[p],l.push(n)}catch(a){m.e(a)}finally{m.f()}f=l;break;case"descendant":f="property"===g.name?b.recursiveSearch(f,function(a){return a===g.value}):b.recursiveSearch(f,function(a,b){return"object"===_typeof(b)||Array.isArray(b)});break;case"descendantValues":f=b.recursiveSearch(f,function(){return!0});break;case"type":var r,s=d.value,t=[],u=_createForOfIteratorHelper(f);try{for(u.s();!(r=u.n()).done;){var B=r.value;b.isType(B,s)&&t.push(B)}}catch(a){u.e(a)}finally{u.f()}f=t;break;case"filter":var C=d.value.match(/^(@)\s*(\.|==)\s*([^ '"]+|".*"|'.*')$/);if(!C)break;var v=null,w=C[3].replace(/^'+|'+$/g,"").replace(/^"+|"+$/g,"");switch(C[2]){case".":v=function(a,b){return a&&a.hasOwnProperty&&a.hasOwnProperty(b)};break;case"==":v=function(a,b){return a==b}}if(v){var x,y=[],z=_createForOfIteratorHelper(f);try{for(z.s();!(x=z.n()).done;){var D=x.value;v(D,w)&&y.push(D)}}catch(a){z.e(a)}finally{z.f()}f=y}}},h=0;h<e.length;h++)g(h);return null==f?[]:f}}]),a}();window.flx1._instances["22317"].registerProperty("jsonpath",new a,!0)})();try{window.flx1._instances["22317"].registerProperty("rule_type_handler_transaction",{mustHaveData:false,getPath:function(id,interactionType,options){return window.flx1._instances["22317"]["rule_type_handler_default"].getPath(id,interactionType,options)},getData:function(options){return window.flx1._instances["22317"]["rule_type_handler_default"].getData(options)},extendFromLocalStorage:function(product){if(product==null){return null}if(localStorage&&typeof localStorage.getItem==="function"&&product.productSKU!=null){try{var savedProduct=JSON.parse(localStorage.getItem("mapp_dmp_cart_"+product.productSKU)||"{}");for(var prop in savedProduct){if(!savedProduct.hasOwnProperty(prop)){continue}var newVar=savedProduct[prop]||product[prop];if(newVar==null){continue}product[prop]=newVar}}catch(ex){if(this.getInstance().debug()){console.error(ex)}}}return product},clearLocalStorageOfKeysStartingWith:function(prefix){for(var prop in localStorage){if(!localStorage.hasOwnProperty(prop)||typeof localStorage[prop]!=="string"){continue}if(prop.startsWith(prefix)){localStorage.removeItem(prop)}}},getInstance:function(){var selfId="22317";return window.flx1._instances[selfId]},getTransactionModule:function(){return this.getInstance()["google_merchant"]()},getTransactionPromise:function(options){var deferred=new $.Deferred;options=options||{};var self=this;var pxl=this.getInstance();if(options.google_merchant_plugin){if(pxl.hasOwnProperty("google_merchant")){if(options.dataMapper==null){if(pxl.debug()){pxl.log("[firepixels - transaction]","Data mapper does not exist in options. Pixel is broken.")}return}var mod=self.getTransactionModule();mod.callbacks.add("transaction",this.id,function(ecommerceData){if(ecommerceData==null){return}var mapper=options.dataMapper;for(var fieldName in mapper.fields){if(!mapper.fields.hasOwnProperty(fieldName)){continue}var field=mapper.fields[fieldName];if(field.assert!==true){continue}if(window.flx1.jsonpath.path({json:ecommerceData,path:field.value}).length<1){if(pxl.debug()){pxl.log("[firepixels - transaction]","Event skipped because pattern:",field.value,"by field:","'"+fieldName+"'","failed to match data:",ecommerceData)}return}}var data=mod.matchEvent(ecommerceData,function(){this.pushField("timestamp",getCurrentTime());for(var fieldName in mapper.fields){if(!mapper.fields.hasOwnProperty(fieldName)){continue}var field=mapper.fields[fieldName];if(field.assert===true){continue}this.pushField(fieldName,this.path(field.value),field.castType,field.defaultValue,field.share)}});for(var prop in data){if(!data.hasOwnProperty(prop)){continue}data[prop]=this.extendFromLocalStorage(data[prop])}this.clearLocalStorageOfKeysStartingWith("mapp_dmp_cart_");deferred.resolve(data)}.bind(this))}}else{var selfInstance=this;var transaction=[];var productRowCssPath=options.product_row_css_path;var rows=$(productRowCssPath);if(rows.length>0){rows.each(function(index){var product=selfInstance.getProduct(index,options);transaction.push(product)})}this.clearLocalStorageOfKeysStartingWith("mapp_dmp_cart_");deferred.resolve(transaction)}return deferred.promise()},getProduct:function(index,options){var product={orderId:null,productSKU:null,productPrice:0,productQuantity:1,returnedQuantity:0};var productRowFields=[{name:"imageURL",css_path:options.product_image_url_css_path,type:"string"},{name:"productURL",css_path:options.product_url_css_path,type:"string"},{name:"productSKU",css_path:options.product_sku_css_path,type:"id"}];var currentProductRowCssPath=options.product_row_css_path+":eq("+index+")";$.each(productRowFields,function(i,field){var cssPath=field.css_path;if(cssPath){var externalData=getExternalData({name:field.name,css_path:currentProductRowCssPath+" "+cssPath,type:field.type});if(externalData){$.extend(product,externalData)}}});product=this.extendFromLocalStorage(product);return product},firePixels:function(path,data,options){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("[firepixels - transaction]",path,data,options)}var sharedFieldDefinitions=[{name:"discountValue",css_path:options.discount_value_css_path,type:"float"},{name:"discountPercent",css_path:options.discount_percent_css_path,type:"float",postProcess:function(val){switch(options.discount_format){case"PERCENTAGE":return val/100;default:return val}}}];var sharedFieldValues={};for(var i in sharedFieldDefinitions){if(!sharedFieldDefinitions.hasOwnProperty(i)){continue}var fieldDef=sharedFieldDefinitions[i];var externalData=getExternalData(fieldDef);if(externalData){sharedFieldValues[fieldDef.name]=externalData}}var mod=this.getTransactionModule();var promise=this.getTransactionPromise(options);promise.done(function(transaction){var generatedOrderId=mod.uuidv4();for(var i in transaction){if(!transaction.hasOwnProperty(i)){continue}var product=transaction[i];product.orderId=product.orderId||generatedOrderId;product.timestamp=getCurrentTime();product.returnedQuantity=0;for(var j in sharedFieldValues){if(!sharedFieldValues.hasOwnProperty(j)){continue}product=$.extend(sharedFieldValues[j],product)}if(data!==null){product=$.extend(data,product)}path+="&data="+encodeURIComponent(window.flx1._instances["22317"].toJson(product));window.flx1._instances["22317"].pxl(path)}}.bind(this))}})}catch(e){window.flx1._instances["22317"].log(e)}try{window.flx1._instances["22317"].registerProperty("rule_type_handler_contact_registration",{mustHaveData:true,getPath:function(id,interactionType,options){return window.flx1._instances["22317"]["rule_type_handler_default"].getPath(id,interactionType,options)},getData:function(options){if(options.hasOwnProperty("group")&&options.hasOwnProperty("mode")&&options.hasOwnProperty("user_identifier")&&options.hasOwnProperty("user_identifier_css_path")){var data=window.flx1._instances["22317"]["rule_type_handler_default"].getData(options);if(data===null){data={}}data["group"]=options.group;data["mode"]=options.mode;var externalData={name:options.user_identifier,css_path:options.user_identifier_css_path};var entry=getExternalData(externalData);if(entry!==null){$.extend(data,entry);return data}}return null},firePixels:function(path,data,options){window.flx1._instances["22317"]["rule_type_handler_default"].firePixels(path,data,options)}})}catch(e){window.flx1._instances["22317"].log(e)}var FLXurl={contains:function(query){return window.location.href.toLowerCase().indexOf(query.toLowerCase())!==-1},doesNotContain:function(query){return!FLXurl.contains(query)},equals:function(query){return window.location.href.toLowerCase()===query.toLowerCase()},doesNotEqual:function(query){return!FLXurl.equals(query)},startsWith:function(query){return window.location.href.toLowerCase().substring(0,query.length)===query.toLowerCase()},endsWith:function(query){return window.location.href.toLowerCase().substring(window.location.href.length-query.length)===query.toLowerCase()},regex:function(query){return new RegExp(query,"i").test(window.location.href)}};var FLXcheckbox={equals:function(path,val){var checkbox=$(path);return checkbox.length>0&&checkbox.is(":checked")===(val==="checked")}};var c=window.flx1.clicks;if(c==null){window.flx1.clicks={handlers:[],doClick:function(event){if(event==null){return}var target=event.target||event.srcElement;if(target==null){return}if(this.handlers.length<1){return}var cur=target;while(cur!=null){var $cur=$(cur);for(var i=0;i<this.handlers.length;i++){var handler=this.handlers[i];if($cur.is(handler.path)){handler.callback()}}cur=cur.parentElement}},push:function(obj){this.handlers.push(obj)}};c=window.flx1.clicks;function clicksHook(){if(this&&this.type==="click"&&this.flx1Event==null){this.flx1Event=true;c.doClick(this)}}hook("Event","stopPropagation",clicksHook);hook("Event","stopImmediatePropagation",clicksHook);document.addEventListener("click",function(e){if(e.flx1Event==null){this.flx1Event=true;c.doClick(e)}},false)}var FLXajax={onClick:function(path,callback){if(typeof path==="string"&&path.length>0){c.push({path:path,callback:callback})}}};(function(){var executor=executeAfterAll(1,function(){var id="20861";var options={rule_name:"All pages",populate_external_pixels:false,platform:"",segment_pixel_advertiser:"",external_pixel_url:"",external_pixel_script:"\n try { window.flx1._instances['22317'].jQuery(function($) {}) } catch(e) { if (window.flx1._instances['22317'].debug()) { window.flx1._instances['22317'].log(e); } }",populate_external_data:false,external_pixel_url_type:"image",externalPixelFields:[],external_data:[],engage_related_data:[],expiration_value:""};var type="segment";var interactionType="15";var ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_"+type];if(ruleTypeHandler){ruleTypeHandler.id=id}if(!ruleTypeHandler||!ruleTypeHandler.getPath||!ruleTypeHandler.getData||!ruleTypeHandler.firePixels){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("Did not found getPath|getData|firePixels in ruleTypeHandler for type: "+type)}ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_default"]}try{var path=ruleTypeHandler.getPath(id,interactionType,options);if(path!==null){if(options.hasOwnProperty("populate_external_pixels")){populateExternalPixels(options,type)}var data=ruleTypeHandler.getData(options);if(ruleTypeHandler.mustHaveData&&data===null){return}ruleTypeHandler.firePixels(path,data,options)}}catch(e){window.flx1._instances["22317"].log(e)}});var checks=[];checks[0]={exec:executeAfter(1,function(){executor.next(0);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===0){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(true){checks[0].exec.next(0)}}}]};if(false){try{var hasMutations=false;window.flx1._instances["22317"].getMutationObserver("observer_20861",function(){hasMutations=true});setInterval(function(){if(hasMutations){doCheck(checks);hasMutations=false}},1e3)}catch(e){window.flx1._instances["22317"].log(e)}}doCheck(checks)})();(function(){var executor=executeAfterAll(1,function(){var id="21447";var options={rule_name:"Purchasing done",assign_value:"0",expiration:false,expiration_value:"",conversion_count_type:"all_per_user",custom_conversion_count_number:"",custom_conversion_count_per:"",populate_external_pixels:true,platform:"custom",external_pixel_url:"",external_pixel_script:"\n try { window.flx1._instances['22317'].jQuery(function($) {console.log(\"pd\")}) } catch(e) { if (window.flx1._instances['22317'].debug()) { window.flx1._instances['22317'].log(e); } }",populate_external_data:false,expiration_unit:"minutes",custom_conversion_count_unit:"minutes",external_pixel_url_type:"image",externalPixelFields:[],external_data:[],engage_related_data:[]};var type="conversion";var interactionType="10";var ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_"+type];if(ruleTypeHandler){ruleTypeHandler.id=id}if(!ruleTypeHandler||!ruleTypeHandler.getPath||!ruleTypeHandler.getData||!ruleTypeHandler.firePixels){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("Did not found getPath|getData|firePixels in ruleTypeHandler for type: "+type)}ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_default"]}try{var path=ruleTypeHandler.getPath(id,interactionType,options);if(path!==null){if(options.hasOwnProperty("populate_external_pixels")){populateExternalPixels(options,type)}var data=ruleTypeHandler.getData(options);if(ruleTypeHandler.mustHaveData&&data===null){return}ruleTypeHandler.firePixels(path,data,options)}}catch(e){window.flx1._instances["22317"].log(e)}});var checks=[];checks[0]={exec:executeAfter(1,function(){executor.next(0);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===0){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(FLXurl.contains("lg.com/it/shop/checkout/onepage/success")){checks[0].exec.next(0)}}}]};if(false){try{var hasMutations=false;window.flx1._instances["22317"].getMutationObserver("observer_21447",function(){hasMutations=true});setInterval(function(){if(hasMutations){doCheck(checks);hasMutations=false}},1e3)}catch(e){window.flx1._instances["22317"].log(e)}}doCheck(checks)})();(function(){var executor=executeAfterAll(1,function(){var id="21448";var options={rule_name:"Transaction",google_merchant_plugin:true,product_row_css_path:"",product_sku_css_path:"",product_url_css_path:"",product_image_url_css_path:"",discount_value_css_path:"",discount_format:"PERCENTAGE",discount_percent_css_path:"",populate_external_data:false,externalPixelFields:[],dataMapper:{fields:{assert:{value:"$..ecommerce.purchase@object()",assert:true},orderId:{value:"$..ecommerce.purchase.actionField.id",share:"single"},productSKU:{value:"$..ecommerce.purchase.products..dimension126"},productName:{value:"$..ecommerce.purchase.products..dimension127"},productPrice:{value:"$..ecommerce.purchase.products..price",castType:"number"},productQuantity:{value:"$..ecommerce.purchase.products..quantity",defaultValue:1,castType:"int"},productURL:{value:"$..ecommerce.purchase.products..default"},imageURL:{value:"$..ecommerce.purchase.products..default"},currency:{value:"$..ecommerce.purchase.products..default",share:"single",castType:"string"},brand:{value:"$..ecommerce.purchase.products..default"},variant:{value:"$..ecommerce.purchase.products..default"},category:{value:"$..ecommerce.purchase.products..default"}}},external_data:[{name:"",css_path:"",default_value:""}],engage_related_data:[],expiration_value:""};var type="transaction";var interactionType="40";var ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_"+type];if(ruleTypeHandler){ruleTypeHandler.id=id}if(!ruleTypeHandler||!ruleTypeHandler.getPath||!ruleTypeHandler.getData||!ruleTypeHandler.firePixels){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("Did not found getPath|getData|firePixels in ruleTypeHandler for type: "+type)}ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_default"]}try{var path=ruleTypeHandler.getPath(id,interactionType,options);if(path!==null){if(options.hasOwnProperty("populate_external_pixels")){populateExternalPixels(options,type)}var data=ruleTypeHandler.getData(options);if(ruleTypeHandler.mustHaveData&&data===null){return}ruleTypeHandler.firePixels(path,data,options)}}catch(e){window.flx1._instances["22317"].log(e)}});var checks=[];checks[0]={exec:executeAfter(1,function(){executor.next(0);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===0){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(FLXurl.contains("lg.com/it/shop/checkout/onepage/success")){checks[0].exec.next(0)}}}]};if(false){try{var hasMutations=false;window.flx1._instances["22317"].getMutationObserver("observer_21448",function(){hasMutations=true});setInterval(function(){if(hasMutations){doCheck(checks);hasMutations=false}},1e3)}catch(e){window.flx1._instances["22317"].log(e)}}doCheck(checks)})();(function(){var executor=executeAfterAll(4,function(){var id="21456";var options={rule_name:"Engage Contact Registration",cepintegration:"1104",group:"550711047",mode:"OPT_IN",user_identifier:"email",user_identifier_css_path:"#txtBoxEmail",populate_external_data:true,externalPixelFields:[],external_data:[],engage_related_data:[],expiration_value:""};var type="contact_registration";var interactionType="39";var ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_"+type];if(ruleTypeHandler){ruleTypeHandler.id=id}if(!ruleTypeHandler||!ruleTypeHandler.getPath||!ruleTypeHandler.getData||!ruleTypeHandler.firePixels){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log("Did not found getPath|getData|firePixels in ruleTypeHandler for type: "+type)}ruleTypeHandler=window.flx1._instances["22317"]["rule_type_handler_default"]}try{var path=ruleTypeHandler.getPath(id,interactionType,options);if(path!==null){if(options.hasOwnProperty("populate_external_pixels")){populateExternalPixels(options,type)}var data=ruleTypeHandler.getData(options);if(ruleTypeHandler.mustHaveData&&data===null){return}ruleTypeHandler.firePixels(path,data,options)}}catch(e){window.flx1._instances["22317"].log(e)}});var checks=[];checks[0]={exec:executeAfter(1,function(){executor.next(0);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===0){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(FLXurl.contains("page/signup")){checks[0].exec.next(0)}}}]};checks[1]={exec:executeAfter(1,function(){executor.next(1);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===1){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(FLXcheckbox.equals("#signUp-chk2","checked")){checks[1].exec.next(0)}}}]};checks[2]={exec:executeAfter(1,function(){executor.next(2);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===2){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){FLXajax.onClick("#signUpForm > fieldset > div > div.btn-area > button",function(){checks[2].exec.next(0,true)})}}]};checks[3]={exec:executeAfter(1,function(){executor.next(3);var reChecks=[];for(var i in checks){if(!checks.hasOwnProperty(i)){continue}if(parseInt(i,10)===3){continue}reChecks.push(checks[i])}doCheck(reChecks)}),options:[{check:function(){if(FLXcheckbox.equals("#signUp-chk1","checked")){checks[3].exec.next(0)}}}]};if(false){try{var hasMutations=false;window.flx1._instances["22317"].getMutationObserver("observer_21456",function(){hasMutations=true});setInterval(function(){if(hasMutations){doCheck(checks);hasMutations=false}},1e3)}catch(e){window.flx1._instances["22317"].log(e)}}doCheck(checks)})()})})();try{window.flx1._instances["22317"].jQuery(function($){if(typeof mappSendData!=="function"){function mappSendData(name,data){if(checkBeforeSend(name,data)){window.flx1._instances["22317"].data(name,data,true)}}}var mapp_existing={};function checkBeforeSend(name,data){if(mapp_existing[name]!=null){if(mapp_existing[name]===data){return false}}mapp_existing[name]=data;return true}function mappSendDataPre(){for(var i=0;i<dataLayer.length;i++){if(dataLayer[i].event=="purchase"){for(var j=0;j<3;j++){var productIndex=j+1;if(dataLayer[i].ecommerce.purchase.products[j]){mappSendData("purchasedID"+productIndex,dataLayer[i].ecommerce.purchase.products[j].id);mappSendData("purchasedProductID"+productIndex,dataLayer[i].ecommerce.purchase.products[j].dimension126);mappSendData("purchasedProductDescription"+productIndex,dataLayer[i].ecommerce.purchase.products[j].dimension127)}else{mappSendData("purchasedID"+productIndex,"");mappSendData("purchasedProductID"+productIndex,"");mappSendData("purchasedProductDescription"+productIndex,"")}}window.clearInterval(mappInterval)}}}function setCartViewWatcher(){mappInterval=window.setInterval(function(){mappSendDataPre()},1e3)}if(window.location.href.includes("lg.com/it/shop/checkout/onepage/success/")){var mappInterval;setCartViewWatcher()}})}catch(e){if(window.flx1._instances["22317"].debug()){window.flx1._instances["22317"].log(e)}}};window["flx1_assign_22317"]();window.flx1._instances["22317"].pxl("/px?id="+window.flx1._instances["22317"].cnf.id+"&m="+window.flx1._instances["22317"].cnf.m)}window.flx1_init=function(){try{var doInit=function(){var finalFlx1=typeof window.flx1["pxl"]==="function"?window.flx1:window.flx1._instances[Object.keys(window.flx1._instances)[0]];finalFlx1._instances=window.flx1._instances;finalFlx1.pixelQueue=window.flx1.pixelQueue;for(var instanceId in window.flx1._instances){if(!window.flx1._instances.hasOwnProperty(instanceId)){continue}var instance=window.flx1._instances[instanceId];for(var prop in instance){if(!instance.hasOwnProperty(prop)||finalFlx1.hasOwnProperty(prop)){continue}finalFlx1[prop]=instance[prop]}}window.flx1=finalFlx1};doInit();var monitI=0;var monitFlx1=function(){monitI++;if(monitI>=300){return}try{if(window.hasOwnProperty("flx1")&&typeof window.flx1==="object"&&typeof window.flx1["pxl"]==="function"&&!window.flx1.hasOwnProperty("_instances")){window.flx1._instances={};window.flx1._instances[window.flx1.cnf.id]=window.flx1;window["flx1_assign_22317"]();doInit()}}catch(emon){}setTimeout(monitFlx1,10)};monitFlx1()}catch(e){window.console&&window.console.log&&window.console.log("flx1 merge warning");try{window.flx1=window.flx1._instances["22317"];window.flx1["_instances"]["22317"]=window.flx1}catch(e2){window.console&&window.console.log&&window.console.log("flx1 merge fallback warning")}}};window.flx1_init()}catch(e){}
